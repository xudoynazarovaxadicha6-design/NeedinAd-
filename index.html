import React, { useState, useEffect } from 'react';

export default function NeedinAdApp() {
  const [currentQuestion, setCurrentQuestion] = useState('');
  const [archivedQuestions, setArchivedQuestions] = useState([]);
  const [questionInput, setQuestionInput] = useState('');
  const [answerInput, setAnswerInput] = useState('');
  const [password, setPassword] = useState('');
  const [showPasswordModal, setShowPasswordModal] = useState(false);
  const [showDeleteModal, setShowDeleteModal] = useState(false);
  const [deletePassword, setDeletePassword] = useState('');
  const [currentView, setCurrentView] = useState('main');
  const [answers, setAnswers] = useState([]);
  const [ownerPassword, setOwnerPassword] = useState('owner123');
  const [currentLang, setCurrentLang] = useState('uz');
  const [oldPassword, setOldPassword] = useState('');
  const [newPassword, setNewPassword] = useState('');
  const [confirmPassword, setConfirmPassword] = useState('');
  const [showSuccess, setShowSuccess] = useState(false);

  const translations = {
    uz: {
      subtitle: "Savol bitta. Fikrlar ko'p.",
      home: "Bosh sahifa",
      archive: "Arxiv",
      settings: "Sozlamalar",
      postQuestion: "Savol joylash",
      questionPlaceholder: "Savolni yozing...",
      postQuestionBtn: "Savolni joylash",
      currentQuestion: "Hozirgi Savol",
      noQuestion: "Hozirda savol yo'q",
      deleteQuestion: "Savolni o'chirish",
      anonymousAnswer: "Anonim javob qoldirish",
      answerPlaceholder: "Fikringizni yozing...",
      sendAnswer: "Javob yuborish",
      answers: "Javoblar",
      noAnswers: "Hozircha javoblar yo'q. Birinchi bo'lib javob qoldiring!",
      archiveTitle: "Arxiv",
      emptyArchive: "Arxivda hech narsa yo'q",
      settingsTitle: "Sozlamalar",
      changesSaved: "O'zgarishlar saqlandi!",
      selectLanguage: "Tilni tanlang:",
      changePassword: "Parolni o'zgartirish (faqat egasi):",
      oldPasswordPlaceholder: "Hozirgi parol",
      newPasswordPlaceholder: "Yangi parol",
      confirmPasswordPlaceholder: "Parolni tasdiqlang",
      changePasswordBtn: "Parolni o'zgartirish",
      enterPassword: "Parolni kiriting",
      ownerPasswordPlaceholder: "Ega paroli...",
      confirm: "Tasdiqlash",
      cancel: "Bekor qilish",
      confirmDelete: "Savolni o'chirishni tasdiqlaysizmi?",
      deleteWarning: "Bu amalni qaytarib bo'lmaydi!",
      delete: "O'chirish",
      answersCount: "javob"
    },
    en: {
      subtitle: "One question. Many thoughts.",
      home: "Home",
      archive: "Archive",
      settings: "Settings",
      postQuestion: "Post Question",
      questionPlaceholder: "Write your question...",
      postQuestionBtn: "Post Question",
      currentQuestion: "Current Question",
      noQuestion: "No question yet",
      deleteQuestion: "Delete Question",
      anonymousAnswer: "Leave Anonymous Answer",
      answerPlaceholder: "Share your thoughts...",
      sendAnswer: "Send Answer",
      answers: "Answers",
      noAnswers: "No answers yet. Be the first!",
      archiveTitle: "Archive",
      emptyArchive: "Archive is empty",
      settingsTitle: "Settings",
      changesSaved: "Changes saved!",
      selectLanguage: "Select Language:",
      changePassword: "Change Password (owner only):",
      oldPasswordPlaceholder: "Current password",
      newPasswordPlaceholder: "New password",
      confirmPasswordPlaceholder: "Confirm password",
      changePasswordBtn: "Change Password",
      enterPassword: "Enter Password",
      ownerPasswordPlaceholder: "Owner password...",
      confirm: "Confirm",
      cancel: "Cancel",
      confirmDelete: "Confirm deletion?",
      deleteWarning: "This cannot be undone!",
      delete: "Delete",
      answersCount: "answers"
    },
    ru: {
      subtitle: "–û–¥–∏–Ω –≤–æ–ø—Ä–æ—Å. –ú–Ω–æ–≥–æ –º—ã—Å–ª–µ–π.",
      home: "–ì–ª–∞–≤–Ω–∞—è",
      archive: "–ê—Ä—Ö–∏–≤",
      settings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
      postQuestion: "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å",
      questionPlaceholder: "–ù–∞–ø–∏—à–∏—Ç–µ –≤–æ–ø—Ä–æ—Å...",
      postQuestionBtn: "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å",
      currentQuestion: "–¢–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å",
      noQuestion: "–ù–µ—Ç –≤–æ–ø—Ä–æ—Å–∞",
      deleteQuestion: "–£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å",
      anonymousAnswer: "–ê–Ω–æ–Ω–∏–º–Ω—ã–π –æ—Ç–≤–µ—Ç",
      answerPlaceholder: "–í–∞—à–∏ –º—ã—Å–ª–∏...",
      sendAnswer: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
      answers: "–û—Ç–≤–µ—Ç—ã",
      noAnswers: "–ù–µ—Ç –æ—Ç–≤–µ—Ç–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!",
      archiveTitle: "–ê—Ä—Ö–∏–≤",
      emptyArchive: "–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç",
      settingsTitle: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
      changesSaved: "–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!",
      selectLanguage: "–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:",
      changePassword: "–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å:",
      oldPasswordPlaceholder: "–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å",
      newPasswordPlaceholder: "–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å",
      confirmPasswordPlaceholder: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ",
      changePasswordBtn: "–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å",
      enterPassword: "–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å",
      ownerPasswordPlaceholder: "–ü–∞—Ä–æ–ª—å...",
      confirm: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å",
      cancel: "–û—Ç–º–µ–Ω–∞",
      confirmDelete: "–£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å?",
      deleteWarning: "–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!",
      delete: "–£–¥–∞–ª–∏—Ç—å",
      answersCount: "–æ—Ç–≤–µ—Ç–æ–≤"
    }
  };

  const t = translations[currentLang];

  useEffect(() => {
    loadData();
  }, []);

  const loadData = async () => {
    try {
      const currentQ = await window.storage.get('needin:current');
      if (currentQ) {
        const data = JSON.parse(currentQ.value);
        setCurrentQuestion(data.question);
        setAnswers(data.answers || []);
      }
      const archived = await window.storage.get('needin:archive');
      if (archived) {
        setArchivedQuestions(JSON.parse(archived.value));
      }
      const savedPass = await window.storage.get('needin:password');
      if (savedPass) {
        setOwnerPassword(savedPass.value);
      }
      const savedLang = await window.storage.get('needin:language');
      if (savedLang) {
        setCurrentLang(savedLang.value);
      }
    } catch (error) {
      console.log('Loading from memory');
    }
  };

  const addQuestion = async () => {
    if (!questionInput.trim()) {
      alert(t.questionPlaceholder);
      return;
    }
    if (password !== ownerPassword) {
      alert(currentLang === 'uz' ? "Parol noto'g'ri!" : currentLang === 'en' ? "Incorrect password!" : "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");
      setPassword('');
      return;
    }

    try {
      if (currentQuestion) {
        const archived = [...archivedQuestions];
        archived.unshift({
          id: Date.now(),
          question: currentQuestion,
          answers: answers,
          date: new Date().toLocaleDateString()
        });
        setArchivedQuestions(archived);
        await window.storage.set('needin:archive', JSON.stringify(archived));
      }

      const newQuestion = {
        question: questionInput.trim(),
        answers: []
      };
      
      await window.storage.set('needin:current', JSON.stringify(newQuestion));
      
      setCurrentQuestion(questionInput.trim());
      setAnswers([]);
      setQuestionInput('');
      setPassword('');
      setShowPasswordModal(false);
      alert(currentLang === 'uz' ? "Savol joylandi!" : currentLang === 'en' ? "Question posted!" : "–í–æ–ø—Ä–æ—Å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω!");
    } catch (error) {
      console.log('Storage error:', error);
    }
  };

  const deleteQuestion = async () => {
    if (deletePassword !== ownerPassword) {
      alert(currentLang === 'uz' ? "Parol noto'g'ri!" : currentLang === 'en' ? "Incorrect password!" : "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");
      setDeletePassword('');
      return;
    }

    try {
      if (currentQuestion) {
        const archived = [...archivedQuestions];
        archived.unshift({
          id: Date.now(),
          question: currentQuestion,
          answers: answers,
          date: new Date().toLocaleDateString()
        });
        setArchivedQuestions(archived);
        await window.storage.set('needin:archive', JSON.stringify(archived));
      }

      await window.storage.delete('needin:current');
      setCurrentQuestion('');
      setAnswers([]);
      setDeletePassword('');
      setShowDeleteModal(false);
      alert(currentLang === 'uz' ? "Savol o'chirildi!" : currentLang === 'en' ? "Question deleted!" : "–í–æ–ø—Ä–æ—Å —É–¥–∞–ª–µ–Ω!");
    } catch (error) {
      console.log('Error:', error);
    }
  };

  const addAnswer = async () => {
    if (!answerInput.trim()) {
      alert(t.answerPlaceholder);
      return;
    }
    if (!currentQuestion) {
      alert(t.noQuestion);
      return;
    }

    try {
      const newAnswers = [answerInput.trim(), ...answers];
      setAnswers(newAnswers);

      const updated = {
        question: currentQuestion,
        answers: newAnswers
      };
      
      await window.storage.set('needin:current', JSON.stringify(updated));
      setAnswerInput('');
      alert(currentLang === 'uz' ? "Javob yuborildi!" : currentLang === 'en' ? "Answer sent!" : "–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!");
    } catch (error) {
      console.log('Storage error:', error);
    }
  };

  const changePassword = async () => {
    if (!oldPassword || !newPassword || !confirmPassword) {
      alert(currentLang === 'uz' ? "Barcha maydonlarni to'ldiring" : currentLang === 'en' ? "Fill all fields" : "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è");
      return;
    }
    if (oldPassword !== ownerPassword) {
      alert(currentLang === 'uz' ? "Hozirgi parol noto'g'ri" : currentLang === 'en' ? "Current password incorrect" : "–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å –Ω–µ–≤–µ—Ä–µ–Ω");
      return;
    }
    if (newPassword !== confirmPassword) {
      alert(currentLang === 'uz' ? "Parollar mos kelmadi" : currentLang === 'en' ? "Passwords don't match" : "–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç");
      return;
    }
    if (newPassword.length < 4) {
      alert(currentLang === 'uz' ? "Parol 4+ belgidan iborat bo'lsin" : currentLang === 'en' ? "Password must be 4+ characters" : "–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 4+ —Å–∏–º–≤–æ–ª–æ–≤");
      return;
    }

    try {
      await window.storage.set('needin:password', newPassword);
      setOwnerPassword(newPassword);
      setOldPassword('');
      setNewPassword('');
      setConfirmPassword('');
      setShowSuccess(true);
      setTimeout(() => setShowSuccess(false), 3000);
    } catch (error) {
      console.log('Error:', error);
    }
  };

  const changeLanguage = async (lang) => {
    setCurrentLang(lang);
    try {
      await window.storage.set('needin:language', lang);
    } catch (error) {
      console.log('Error:', error);
    }
  };

  return (
    <div style={{
      fontFamily: 'Arial, sans-serif',
      background: '#0f0f0f',
      color: '#fff',
      padding: '24px',
      minHeight: '100vh',
      maxWidth: '800px',
      margin: '0 auto'
    }}>
      {/* Header */}
      <div style={{ marginBottom: '30px' }}>
        <h1 style={{ fontSize: '36px', margin: '0 0 10px 0' }}>NeedinAd</h1>
        <p style={{ color: '#aaa', margin: '0 0 20px 0' }}>{t.subtitle}</p>
        <div style={{ display: 'flex', gap: '10px', flexWrap: 'wrap' }}>
          <button onClick={() => setCurrentView('main')} style={btnStyle}>
            üè† {t.home}
          </button>
          <button onClick={() => setCurrentView('archive')} style={btnStyle}>
            üìö {t.archive}
          </button>
          <button onClick={() => setCurrentView('settings')} style={btnStyle}>
            ‚öôÔ∏è {t.settings}
          </button>
        </div>
      </div>

      {/* Main View */}
      {currentView === 'main' && (
        <>
          <div style={boxStyle}>
            <h3 style={h3Style}>{t.postQuestion} (faqat egasi) üîê</h3>
            <input
              type="text"
              value={questionInput}
              onChange={(e) => setQuestionInput(e.target.value)}
              placeholder={t.questionPlaceholder}
              style={inputStyle}
            />
            <button onClick={() => setShowPasswordModal(true)} style={primaryBtnStyle}>
              {t.postQuestionBtn}
            </button>
          </div>

          <div style={boxStyle}>
            <h3 style={h3Style}>üìå {t.currentQuestion}</h3>
            {currentQuestion ? (
              <>
                <p style={{
                  margin: 0,
                  fontSize: '16px',
                  lineHeight: '1.5',
                  background: '#222',
                  padding: '12px',
                  borderRadius: '6px'
                }}>{currentQuestion}</p>
                <button onClick={() => setShowDeleteModal(true)} style={deleteBtnStyle}>
                  üóëÔ∏è {t.deleteQuestion}
                </button>
              </>
            ) : (
              <p style={emptyStyle}>{t.noQuestion}</p>
            )}
          </div>

          <div style={boxStyle}>
            <h3 style={h3Style}>üí¨ {t.anonymousAnswer}</h3>
            <textarea
              value={answerInput}
              onChange={(e) => setAnswerInput(e.target.value)}
              placeholder={t.answerPlaceholder}
              style={textareaStyle}
            />
            <button onClick={addAnswer} style={primaryBtnStyle}>
              {t.sendAnswer}
            </button>
          </div>

          <div style={boxStyle}>
            <h3 style={h3Style}>üí≠ {t.answers} ({answers.length})</h3>
            {answers.length === 0 ? (
              <p style={emptyStyle}>{t.noAnswers}</p>
            ) : (
              answers.map((ans, idx) => (
                <div key={idx} style={answerStyle}>{ans}</div>
              ))
            )}
          </div>
        </>
      )}

      {/* Archive View */}
      {currentView === 'archive' && (
        <div style={boxStyle}>
          <h2 style={{ margin: '0 0 20px 0', fontSize: '24px' }}>üìö {t.archiveTitle}</h2>
          {archivedQuestions.length === 0 ? (
            <p style={emptyStyle}>{t.emptyArchive}</p>
          ) : (
            archivedQuestions.map((item) => (
              <div key={item.id} style={{
                background: '#222',
                padding: '16px',
                borderRadius: '8px',
                marginBottom: '16px'
              }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '12px' }}>
                  <h3 style={{ margin: 0, fontSize: '16px', color: '#4CAF50', flex: 1 }}>
                    {item.question}
                  </h3>
                  <span style={{ fontSize: '12px', color: '#888', marginLeft: '12px' }}>
                    {item.date}
                  </span>
                </div>
                <div style={{ paddingLeft: '12px', borderLeft: '3px solid #333' }}>
                  <p style={{ margin: '0 0 8px 0', fontSize: '14px', color: '#aaa' }}>
                    {item.answers.length} {t.answersCount}
                  </p>
                  {item.answers.slice(0, 3).map((ans, idx) => (
                    <div key={idx} style={{
                      background: '#1a1a1a',
                      padding: '8px',
                      borderRadius: '4px',
                      marginBottom: '6px',
                      fontSize: '14px',
                      color: '#ccc'
                    }}>{ans}</div>
                  ))}
                  {item.answers.length > 3 && (
                    <p style={{ fontSize: '12px', color: '#666', fontStyle: 'italic' }}>
                      ... {currentLang === 'uz' ? 'va yana' : currentLang === 'en' ? 'and' : '–∏ –µ—â—ë'} {item.answers.length - 3} {t.answersCount}
                    </p>
                  )}
                </div>
              </div>
            ))
          )}
        </div>
      )}

      {/* Settings View */}
      {currentView === 'settings' && (
        <div style={boxStyle}>
          <h2 style={{ margin: '0 0 20px 0', fontSize: '24px' }}>‚öôÔ∏è {t.settingsTitle}</h2>
          
          {showSuccess && (
            <div style={{
              background: '#4CAF50',
              color: 'white',
              padding: '12px',
              borderRadius: '4px',
              marginBottom: '16px'
            }}>{t.changesSaved}</div>
          )}

          <div style={{ marginBottom: '20px' }}>
            <label style={{ display: 'block', marginBottom: '8px', color: '#aaa', fontSize: '14px' }}>
              {t.selectLanguage}
            </label>
            <select
              value={currentLang}
              onChange={(e) => changeLanguage(e.target.value)}
              style={inputStyle}
            >
              <option value="uz">O'zbek</option>
              <option value="en">English</option>
              <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            </select>
          </div>

          <div style={{ marginBottom: '20px' }}>
            <label style={{ display: 'block', marginBottom: '8px', color: '#aaa', fontSize: '14px' }}>
              {t.changePassword}
            </label>
            <input
              type="password"
              value={oldPassword}
              onChange={(e) => setOldPassword(e.target.value)}
              placeholder={t.oldPasswordPlaceholder}
              style={inputStyle}
            />
            <input
              type="password"
              value={newPassword}
              onChange={(e) => setNewPassword(e.target.value)}
              placeholder={t.newPasswordPlaceholder}
              style={inputStyle}
            />
            <input
              type="password"
              value={confirmPassword}
              onChange={(e) => setConfirmPassword(e.target.value)}
              placeholder={t.confirmPasswordPlaceholder}
              style={inputStyle}
            />
            <button onClick={changePassword} style={primaryBtnStyle}>
              {t.changePasswordBtn}
            </button>
          </div>
        </div>
      )}

      {/* Password Modal */}
      {showPasswordModal && (
        <div style={modalStyle}>
          <div style={modalContentStyle}>
            <h3 style={{ margin: '0 0 16px 0' }}>{t.enterPassword}</h3>
            <input
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              placeholder={t.ownerPasswordPlaceholder}
              style={{ ...inputStyle, border: '1px solid #444' }}
              onKeyPress={(e) => e.key === 'Enter' && addQuestion()}
            />
            <div style={{ display: 'flex', gap: '10px' }}>
              <button onClick={addQuestion} style={successBtnStyle}>
                {t.confirm}
              </button>
              <button onClick={() => { setShowPasswordModal(false); setPassword(''); }} style={dangerBtnStyle}>
                {t.cancel}
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Delete Modal */}
      {showDeleteModal && (
        <div style={modalStyle}>
          <div style={modalContentStyle}>
            <h3 style={{ margin: '0 0 16px 0' }}>{t.confirmDelete}</h3>
            <p style={{ color: '#aaa', marginBottom: '16px' }}>{t.deleteWarning}</p>
            <input
              type="password"
              value={deletePassword}
              onChange={(e) => setDeletePassword(e.target.value)}
              placeholder={t.ownerPasswordPlaceholder}
              style={{ ...inputStyle, border: '1px solid #444' }}
              onKeyPress={(e) => e.key === 'Enter' && deleteQuestion()}
            />
            <div style={{ display: 'flex', gap: '10px' }}>
              <button onClick={deleteQuestion} style={dangerBtnStyle}>
                {t.delete}
              </button>
              <button onClick={() => { setShowDeleteModal(false); setDeletePassword(''); }} style={successBtnStyle}>
                {t.cancel}
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}

const btnStyle = { padding: '8px 16px', background: '#333', color: '#fff', border: 'none', borderRadius: '4px', cursor: 'pointer', fontSize: '14px' };
const boxStyle = { background: '#1a1a1a', padding: '16px', borderRadius: '8px', marginBottom: '16px' };
const h3Style = { margin: '0 0 12px 0', fontSize: '18px' };
const inputStyle = { width: '100%', padding: '10px', marginBottom: '10px', ba<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NeedinAd - Savol bitta. Fikrlar ko'p.</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background: #0f0f0f;
      color: #fff;
      padding: 24px;
      min-height: 100vh;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    h1 {
      font-size: 36px;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #aaa;
      margin-bottom: 20px;
    }

    .header-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 8px 16px;
      background: #333;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }

    .btn:hover {
      background: #444;
    }

    .box {
      background: #1a1a1a;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
    }

    .box h3 {
      margin: 0 0 12px 0;
      font-size: 18px;
    }

    input, textarea, select {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      background: #222;
      color: #fff;
      border: none;
      border-radius: 4px;
      font-family: Arial, sans-serif;
    }

    textarea {
      min-height: 80px;
      resize: vertical;
    }

    .btn-primary {
      padding: 10px;
      background: #fff;
      color: #000;
      border: none;
      width: 100%;
      cursor: pointer;
      border-radius: 4px;
      font-weight: bold;
    }

    .btn-primary:hover {
      background: #ddd;
    }

    .btn-delete {
      padding: 8px 16px;
      background: #f44336;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 10px;
    }

    .btn-delete:hover {
      background: #d32f2f;
    }

    .answer {
      background: #222;
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 8px;
      color: #ddd;
      word-wrap: break-word;
    }

    .question-display {
      margin: 0;
      font-size: 16px;
      line-height: 1.5;
      background: #222;
      padding: 12px;
      border-radius: 6px;
    }

    .empty-state {
      color: #888;
      font-style: italic;
      margin: 0;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: #1a1a1a;
      padding: 24px;
      border-radius: 8px;
      max-width: 400px;
      width: 90%;
    }

    .modal-content h3 {
      margin: 0 0 16px 0;
    }

    .modal-buttons {
      display: flex;
      gap: 10px;
    }

    .btn-success {
      flex: 1;
      padding: 10px;
      background: #4CAF50;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }

    .btn-danger {
      flex: 1;
      padding: 10px;
      background: #f44336;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }

    .archive-item {
      background: #222;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
    }

    .archive-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 12px;
    }

    .archive-question {
      margin: 0;
      font-size: 16px;
      color: #4CAF50;
      flex: 1;
    }

    .archive-date {
      font-size: 12px;
      color: #888;
      margin-left: 12px;
    }

    .archive-answers {
      padding-left: 12px;
      border-left: 3px solid #333;
    }

    .archive-count {
      margin: 0 0 8px 0;
      font-size: 14px;
      color: #aaa;
    }

    .archive-answer {
      background: #1a1a1a;
      padding: 8px;
      border-radius: 4px;
      margin-bottom: 6px;
      font-size: 14px;
      color: #ccc;
    }

    .archive-more {
      font-size: 12px;
      color: #666;
      font-style: italic;
      margin: 8px 0 0 0;
    }

    #mainView, #archiveView, #settingsView {
      display: none;
    }

    #mainView.active, #archiveView.active, #settingsView.active {
      display: block;
    }

    .settings-item {
      margin-bottom: 20px;
    }

    .settings-item label {
      display: block;
      margin-bottom: 8px;
      color: #aaa;
      font-size: 14px;
    }

    .success-message {
      background: #4CAF50;
      color: white;
      padding: 12px;
      border-radius: 4px;
      margin-bottom: 16px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div>
      <h1>NeedinAd</h1>
      <p class="subtitle" id="subtitle">Savol bitta. Fikrlar ko'p.</p>
      <div class="header-buttons">
        <button class="btn" id="mainViewBtn">üè† <span data-lang="home">Bosh sahifa</span></button>
        <button class="btn" id="archiveViewBtn">üìö <span data-lang="archive">Arxiv</span></button>
        <button class="btn" id="settingsViewBtn">‚öôÔ∏è <span data-lang="settings">Sozlamalar</span></button>
      </div>
    </div>

    <!-- Main View -->
    <div id="mainView" class="active">
      <!-- Owner: Add Question -->
      <div class="box">
        <h3><span data-lang="postQuestion">Savol joylash</span> (faqat egasi) üîê</h3>
        <input type="text" id="questionInput" data-placeholder="questionPlaceholder" placeholder="Savolni yozing..." />
        <button class="btn-primary" id="addQuestionBtn" data-lang="postQuestionBtn">Savolni joylash</button>
      </div>

      <!-- Current Question -->
      <div class="box">
        <h3>üìå <span data-lang="currentQuestion">Hozirgi Savol</span></h3>
        <div id="currentQuestion">
          <p class="empty-state" data-lang="noQuestion">Hozirda savol yo'q</p>
        </div>
        <button class="btn-delete" id="deleteQuestionBtn" style="display: none;" data-lang="deleteQuestion">
          üóëÔ∏è Savolni o'chirish
        </button>
      </div>

      <!-- Add Answer -->
      <div class="box">
        <h3>üí¨ <span data-lang="anonymousAnswer">Anonim javob qoldirish</span></h3>
        <textarea id="answerInput" data-placeholder="answerPlaceholder" placeholder="Fikringizni yozing..."></textarea>
        <button class="btn-primary" id="addAnswerBtn" data-lang="sendAnswer">Javob yuborish</button>
      </div>

      <!-- Answers -->
      <div class="box">
        <h3>üí≠ <span data-lang="answers">Javoblar</span> <span id="answerCount">(0)</span></h3>
        <div id="answersList">
          <p class="empty-state" data-lang="noAnswers">Hozircha javoblar yo'q. Birinchi bo'lib javob qoldiring!</p>
        </div>
      </div>
    </div>

    <!-- Archive View -->
    <div id="archiveView">
      <div class="box">
        <h2 style="margin: 0 0 20px 0; font-size: 24px;">üìö <span data-lang="archiveTitle">Arxiv</span></h2>
        <div id="archiveList">
          <p class="empty-state" data-lang="emptyArchive">Arxivda hech narsa yo'q</p>
        </div>
      </div>
    </div>

    <!-- Settings View -->
    <div id="settingsView">
      <div class="box">
        <h2 style="margin: 0 0 20px 0; font-size: 24px;">‚öôÔ∏è <span data-lang="settingsTitle">Sozlamalar</span></h2>
        
        <div id="successMessage" class="success-message" style="display: none;">
          <span data-lang="changesSaved">O'zgarishlar saqlandi!</span>
        </div>

        <!-- Language Selection -->
        <div class="settings-item">
          <label><span data-lang="selectLanguage">Tilni tanlang:</span></label>
          <select id="languageSelect">
            <option value="uz">O'zbek</option>
            <option value="en">English</option>
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
          </select>
        </div>

        <!-- Change Password -->
        <div class="settings-item">
          <label><span data-lang="changePassword">Parolni o'zgartirish (faqat egasi):</span></label>
          <input type="password" id="oldPassword" data-placeholder="oldPasswordPlaceholder" placeholder="Hozirgi parol" />
          <input type="password" id="newPassword" data-placeholder="newPasswordPlaceholder" placeholder="Yangi parol" />
          <input type="password" id="confirmPassword" data-placeholder="confirmPasswordPlaceholder" placeholder="Parolni tasdiqlang" />
          <button class="btn-primary" id="changePasswordBtn" data-lang="changePasswordBtn">Parolni o'zgartirish</button>
        </div>
      </div>
    </div>

    <!-- Password Modal -->
    <div id="passwordModal" class="modal">
      <div class="modal-content">
        <h3 data-lang="enterPassword">Parolni kiriting</h3>
        <input type="password" id="passwordInput" data-placeholder="ownerPasswordPlaceholder" placeholder="Ega paroli..." />
        <div class="modal-buttons">
          <button class="btn-success" id="confirmPasswordBtn" data-lang="confirm">Tasdiqlash</button>
          <button class="btn-danger" id="cancelPasswordBtn" data-lang="cancel">Bekor qilish</button>
        </div>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
      <div class="modal-content">
        <h3 data-lang="confirmDelete">Savolni o'chirishni tasdiqlaysizmi?</h3>
        <p style="color: #aaa; margin-bottom: 16px;" data-lang="deleteWarning">Bu amalni qaytarib bo'lmaydi!</p>
        <input type="password" id="deletePasswordInput" data-placeholder="ownerPasswordPlaceholder" placeholder="Ega paroli..." />
        <div class="modal-buttons">
          <button class="btn-danger" id="confirmDeleteBtn" data-lang="delete">O'chirish</button>
          <button class="btn-success" id="cancelDeleteBtn" data-lang="cancel">Bekor qilish</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Translations
    const translations = {
      uz: {
        subtitle: "Savol bitta. Fikrlar ko'p.",
        home: "Bosh sahifa",
        archive: "Arxiv",
        settings: "Sozlamalar",
        postQuestion: "Savol joylash",
        questionPlaceholder: "Savolni yozing...",
        postQuestionBtn: "Savolni joylash",
        currentQuestion: "Hozirgi Savol",
        noQuestion: "Hozirda savol yo'q",
        deleteQuestion: "üóëÔ∏è Savolni o'chirish",
        anonymousAnswer: "Anonim javob qoldirish",
        answerPlaceholder: "Fikringizni yozing...",
        sendAnswer: "Javob yuborish",
        answers: "Javoblar",
        noAnswers: "Hozircha javoblar yo'q. Birinchi bo'lib javob qoldiring!",
        archiveTitle: "Arxiv",
        emptyArchive: "Arxivda hech narsa yo'q",
        settingsTitle: "Sozlamalar",
        changesSaved: "O'zgarishlar saqlandi!",
        selectLanguage: "Tilni tanlang:",
        changePassword: "Parolni o'zgartirish (faqat egasi):",
        oldPasswordPlaceholder: "Hozirgi parol",
        newPasswordPlaceholder: "Yangi parol",
        confirmPasswordPlaceholder: "Parolni tasdiqlang",
        changePasswordBtn: "Parolni o'zgartirish",
        enterPassword: "Parolni kiriting",
        ownerPasswordPlaceholder: "Ega paroli...",
        confirm: "Tasdiqlash",
        cancel: "Bekor qilish",
        confirmDelete: "Savolni o'chirishni tasdiqlaysizmi?",
        deleteWarning: "Bu amalni qaytarib bo'lmaydi!",
        delete: "O'chirish",
        answersCount: "javob"
      },
      en: {
        subtitle: "One question. Many thoughts.",
        home: "Home",
        archive: "Archive",
        settings: "Settings",
        postQuestion: "Post Question",
        questionPlaceholder: "Write your question...",
        postQuestionBtn: "Post Question",
        currentQuestion: "Current Question",
        noQuestion: "No question yet",
        deleteQuestion: "üóëÔ∏è Delete Question",
        anonymousAnswer: "Leave Anonymous Answer",
        answerPlaceholder: "Share your thoughts...",
        sendAnswer: "Send Answer",
        answers: "Answers",
        noAnswers: "No answers yet. Be the first to answer!",
        archiveTitle: "Archive",
        emptyArchive: "Archive is empty",
        settingsTitle: "Settings",
        changesSaved: "Changes saved!",
        selectLanguage: "Select Language:",
        changePassword: "Change Password (owner only):",
        oldPasswordPlaceholder: "Current password",
        newPasswordPlaceholder: "New password",
        confirmPasswordPlaceholder: "Confirm password",
        changePasswordBtn: "Change Password",
        enterPassword: "Enter Password",
        ownerPasswordPlaceholder: "Owner password...",
        confirm: "Confirm",
        cancel: "Cancel",
        confirmDelete: "Confirm question deletion?",
        deleteWarning: "This action cannot be undone!",
        delete: "Delete",
        answersCount: "answers"
      },
      ru: {
        subtitle: "–û–¥–∏–Ω –≤–æ–ø—Ä–æ—Å. –ú–Ω–æ–≥–æ –º—ã—Å–ª–µ–π.",
        home: "–ì–ª–∞–≤–Ω–∞—è",
        archive: "–ê—Ä—Ö–∏–≤",
        settings: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
        postQuestion: "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å",
        questionPlaceholder: "–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å...",
        postQuestionBtn: "–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å",
        currentQuestion: "–¢–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å",
        noQuestion: "–ù–µ—Ç –≤–æ–ø—Ä–æ—Å–∞",
        deleteQuestion: "üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å",
        anonymousAnswer: "–û—Å—Ç–∞–≤–∏—Ç—å –∞–Ω–æ–Ω–∏–º–Ω—ã–π –æ—Ç–≤–µ—Ç",
        answerPlaceholder: "–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º–∏ –º—ã—Å–ª—è–º–∏...",
        sendAnswer: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç",
        answers: "–û—Ç–≤–µ—Ç—ã",
        noAnswers: "–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!",
        archiveTitle: "–ê—Ä—Ö–∏–≤",
        emptyArchive: "–ê—Ä—Ö–∏–≤ –ø—É—Å—Ç",
        settingsTitle: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
        changesSaved: "–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!",
        selectLanguage: "–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:",
        changePassword: "–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü):",
        oldPasswordPlaceholder: "–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å",
        newPasswordPlaceholder: "–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å",
        confirmPasswordPlaceholder: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å",
        changePasswordBtn: "–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å",
        enterPassword: "–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å",
        ownerPasswordPlaceholder: "–ü–∞—Ä–æ–ª—å –≤–ª–∞–¥–µ–ª—å—Ü–∞...",
        confirm: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å",
        cancel: "–û—Ç–º–µ–Ω–∞",
        confirmDelete: "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞?",
        deleteWarning: "–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!",
        delete: "–£–¥–∞–ª–∏—Ç—å",
        answersCount: "–æ—Ç–≤–µ—Ç–æ–≤"
      }
    };

    // Settings
    let OWNER_PASSWORD = localStorage.getItem('needinad_password') || 'owner123';
    let currentLang = localStorage.getItem('needinad_language') || 'uz';
    let currentView = 'main';
    let modalAction = '';

    // Apply language
    function applyLanguage(lang) {
      currentLang = lang;
      localStorage.setItem('needinad_language', lang);
      
      document.getElementById('subtitle').textContent = translations[lang].subtitle;
      
      document.querySelectorAll('[data-lang]').forEach(el => {
        const key = el.getAttribute('data-lang');
        if (translations[lang][key]) {
          el.textContent = translations[lang][key];
        }
      });

      document.querySelectorAll('[data-placeholder]').forEach(el => {
        const key = el.getAttribute('data-placeholder');
        if (translations[lang][key]) {
          el.placeholder = translations[lang][key];
        }
      });
    }

    // Get data from localStorage
    function getData() {
      const current = localStorage.getItem('needinad_current');
      const archive = localStorage.getItem('needinad_archive');
      return {
        current: current ? JSON.parse(current) : null,
        archive: archive ? JSON.parse(archive) : []
      };
    }

    // Save data to localStorage
    function saveData(current, archive) {
      if (current !== null) {
        localStorage.setItem('needinad_current', JSON.stringify(current));
      }
      if (archive) {
        localStorage.setItem('needinad_archive', JSON.stringify(archive));
      }
    }

    // Escape HTML to prevent XSS
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // View switching
    document.getElementById('mainViewBtn').addEventListener('click', () => switchView('main'));
    document.getElementById('archiveViewBtn').addEventListener('click', () => switchView('archive'));
    document.getElementById('settingsViewBtn').addEventListener('click', () => switchView('settings'));

    function switchView(view) {
      currentView = view;
      document.getElementById('mainView').classList.remove('active');
      document.getElementById('archiveView').classList.remove('active');
      document.getElementById('settingsView').classList.remove('active');
      
      if (view === 'main') {
        document.getElementById('mainView').classList.add('active');
        render();
      } else if (view === 'archive') {
        document.getElementById('archiveView').classList.add('active');
        renderArchive();
      } else if (view === 'settings') {
        document.getElementById('settingsView').classList.add('active');
      }
    }

    // Language change
    document.getElementById('languageSelect').value = currentLang;
    document.getElementById('languageSelect').addEventListener('change', (e) => {
      applyLanguage(e.target.value);
      if (currentView === 'archive') renderArchive();
      if (currentView === 'main') render();
    });

    // Change password
    document.getElementById('changePasswordBtn').addEventListener('click', () => {
      const oldPass = document.getElementById('oldPassword').value;
      const newPass = document.getElementById('newPassword').value;
      const confirmPass = document.getElementById('confirmPassword').value;

      if (!oldPass || !newPass || !confirmPass) {
        alert(currentLang === 'uz' ? 'Barcha maydonlarni to\'ldiring' : 
              currentLang === 'en' ? 'Fill all fields' : '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
        return;
      }

      if (oldPass !== OWNER_PASSWORD) {
        alert(currentLang === 'uz' ? 'Hozirgi parol noto\'g\'ri' : 
              currentLang === 'en' ? 'Current password is incorrect' : '–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å –Ω–µ–≤–µ—Ä–µ–Ω');
        return;
      }

      if (newPass !== confirmPass) {
        alert(currentLang === 'uz' ? 'Yangi parollar mos kelmadi' : 
              currentLang === 'en' ? 'New passwords do not match' : '–ù–æ–≤—ã–µ –ø–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
        return;
      }

      if (newPass.length < 4) {
        alert(currentLang === 'uz' ? 'Parol kamida 4 ta belgidan iborat bo\'lishi kerak' : 
              currentLang === 'en' ? 'Password must be at least 4 characters' : '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 4 —Å–∏–º–≤–æ–ª–æ–≤');
        return;
      }

      OWNER_PASSWORD = newPass;
      localStorage.setItem('needinad_password', newPass);
      
      document.getElementById('oldPassword').value = '';
      document.getElementById('newPassword').value = '';
      document.getElementById('confirmPassword').value = '';
      
      const msg = document.getElementById('successMessage');
      msg.style.display = 'block';
      setTimeout(() => msg.style.display = 'none', 3000);
    });

    // Add question
    document.getElementById('addQuestionBtn').addEventListener('click', () => {
      const question = document.getElementById('questionInput').value.trim();
      if (!question) {
        alert(currentLang === 'uz' ? 'Savolni yozing!' : 
              currentLang === 'en' ? 'Write a question!' : '–ù–∞–ø–∏—à–∏—Ç–µ –≤–æ–ø—Ä–æ—Å!');
        return;
      }
      modalAction = 'add';
      document.getElementById('passwordModal').classList.add('active');
    });

    // Delete question
    document.getElementById('deleteQuestionBtn').addEventListener('click', () => {
      document.getElementById('deleteModal').classList.add('active');
    });

    // Confirm delete
    document.getElementById('confirmDeleteBtn').addEventListener('click', () => {
      const password = document.getElementById('dele
      <!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NeedinAd - Savol bitta. Fikrlar ko'p.</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background: #0f0f0f;
      color: #fff;
      padding: 24px;
      min-height: 100vh;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    h1 {
      font-size: 36px;
      margin-bottom: 10px;
    }

    .subtitle {
      color: #aaa;
      margin-bottom: 20px;
    }

    .btn {
      padding: 8px 16px;
      background: #333;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin-bottom: 20px;
    }

    .btn:hover {
      background: #444;
    }

    .box {
      background: #1a1a1a;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
    }

    .box h3 {
      margin: 0 0 12px 0;
      font-size: 18px;
    }

    input, textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      background: #222;
      color: #fff;
      border: none;
      border-radius: 4px;
      font-family: Arial, sans-serif;
    }

    textarea {
      min-height: 80px;
      resize: vertical;
    }

    .btn-primary {
      padding: 10px;
      background: #fff;
      color: #000;
      border: none;
      width: 100%;
      cursor: pointer;
      border-radius: 4px;
      font-weight: bold;
    }

    .btn-primary:hover {
      background: #ddd;
    }

    .answer {
      background: #222;
      padding: 10px;
      border-radius: 6px;
      margin-bottom: 8px;
      color: #ddd;
      word-wrap: break-word;
    }

    .question-display {
      margin: 0;
      font-size: 16px;
      line-height: 1.5;
      background: #222;
      padding: 12px;
      border-radius: 6px;
    }

    .empty-state {
      color: #888;
      font-style: italic;
      margin: 0;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: #1a1a1a;
      padding: 24px;
      border-radius: 8px;
      max-width: 400px;
      width: 90%;
    }

    .modal-content h3 {
      margin: 0 0 16px 0;
    }

    .modal-buttons {
      display: flex;
      gap: 10px;
    }

    .btn-success {
      flex: 1;
      padding: 10px;
      background: #4CAF50;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }

    .btn-danger {
      flex: 1;
      padding: 10px;
      background: #f44336;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }

    .archive-item {
      background: #222;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 16px;
    }

    .archive-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 12px;
    }

    .archive-question {
      margin: 0;
      font-size: 16px;
      color: #4CAF50;
      flex: 1;
    }

    .archive-date {
      font-size: 12px;
      color: #888;
      margin-left: 12px;
    }

    .archive-answers {
      padding-left: 12px;
      border-left: 3px solid #333;
    }

    .archive-count {
      margin: 0 0 8px 0;
      font-size: 14px;
      color: #aaa;
    }

    .archive-answer {
      background: #1a1a1a;
      padding: 8px;
      border-radius: 4px;
      margin-bottom: 6px;
      font-size: 14px;
      color: #ccc;
    }

    .archive-more {
      font-size: 12px;
      color: #666;
      font-style: italic;
      margin: 8px 0 0 0;
    }

    #mainView, #archiveView {
      display: none;
    }

    #mainView.active, #archiveView.active {
      display: block;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div>
      <h1>NeedinAd</h1>
      <p class="subtitle">Savol bitta. Fikrlar ko'p.</p>
      <button class="btn" id="toggleViewBtn">üìö Arxivni ko'rish</button>
    </div>

    <!-- Main View -->
    <div id="mainView" class="active">
      <!-- Owner: Add Question -->
      <div class="box">
        <h3>Savol joylash (faqat egasi) üîê</h3>
        <input type="text" id="questionInput" placeholder="Savolni yozing..." />
        <button class="btn-primary" id="addQuestionBtn">Savolni joylash</button>
      </div>

      <!-- Current Question -->
      <div class="box">
        <h3>üìå Hozirgi Savol</h3>
        <div id="currentQuestion">
          <p class="empty-state">Hozirda savol yo'q</p>
        </div>
      </div>

      <!-- Add Answer -->
      <div class="box">
        <h3>üí¨ Anonim javob qoldirish</h3>
        <textarea id="answerInput" placeholder="Fikringizni yozing..."></textarea>
        <button class="btn-primary" id="addAnswerBtn">Javob yuborish</button>
      </div>

      <!-- Answers -->
      <div class="box">
        <h3>üí≠ Javoblar <span id="answerCount">(0)</span></h3>
        <div id="answersList">
          <p class="empty-state">Hozircha javoblar yo'q. Birinchi bo'lib javob qoldiring!</p>
        </div>
      </div>
    </div>

    <!-- Archive View -->
    <div id="archiveView">
      <div class="box">
        <h2 style="margin: 0 0 20px 0; font-size: 24px;">üìö Arxiv</h2>
        <div id="archiveList">
          <p class="empty-state">Arxivda hech narsa yo'q</p>
        </div>
      </div>
    </div>

    <!-- Password Modal -->
    <div id="passwordModal" class="modal">
      <div class="modal-content">
        <h3>Parolni kiriting</h3>
        <input type="password" id="passwordInput" placeholder="Ega paroli..." />
        <div class="modal-buttons">
          <button class="btn-success" id="confirmPasswordBtn">Tasdiqlash</button>
          <button class="btn-danger" id="cancelPasswordBtn">Bekor qilish</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const OWNER_PASSWORD = 'owner123';
    let currentView = 'main';

    // Get data from localStorage
    function getData() {
      const current = localStorage.getItem('needinad_current');
      const archive = localStorage.getItem('needinad_archive');
      return {
        current: current ? JSON.parse(current) : null,
        archive: archive ? JSON.parse(archive) : []
      };
    }

    // Save data to localStorage
    function saveData(current, archive) {
      if (current) {
        localStorage.setItem('needinad_current', JSON.stringify(current));
      }
      if (archive) {
        localStorage.setItem('needinad_archive', JSON.stringify(archive));
      }
    }

    // Escape HTML to prevent XSS
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Toggle between main and archive view
    document.getElementById('toggleViewBtn').addEventListener('click', () => {
      if (currentView === 'main') {
        currentView = 'archive';
        document.getElementById('mainView').classList.remove('active');
        document.getElementById('archiveView').classList.add('active');
        document.getElementById('toggleViewBtn').textContent = '‚Üê Orqaga';
        renderArchive();
      } else {
        currentView = 'main';
        document.getElementById('mainView').classList.add('active');
        document.getElementById('archiveView').classList.remove('active');
        document.getElementById('toggleViewBtn').textContent = 'üìö Arxivni ko\'rish';
      }
    });

    // Add question
    document.getElementById('addQuestionBtn').addEventListener('click', () => {
      const question = document.getElementById('questionInput').value.trim();
      if (!question) {
        alert('Savolni yozing!');
        return;
      }
      document.getElementById('passwordModal').classList.add('active');
    });

    // Confirm password
    document.getElementById('confirmPasswordBtn').addEventListener('click', () => {
      const password = document.getElementById('passwordInput').value;
      const question = document.getElementById('questionInput').value.trim();

      if (password !== OWNER_PASSWORD) {
        alert('Parol noto\'g\'ri!');
        document.getElementById('passwordInput').value = '';
        return;
      }

      const data = getData();
      
      // Archive current question if exists
      if (data.current && data.current.question) {
        data.archive.unshift({
          id: Date.now(),
          question: data.current.question,
          answers: data.current.answers || [],
          date: new Date().toLocaleDateString('uz-UZ')
        });
      }

      // Save new question
      const newCurrent = {
        question: question,
        answers: []
      };

      saveData(newCurrent, data.archive);

      document.getElementById('questionInput').value = '';
      document.getElementById('passwordInput').value = '';
      document.getElementById('passwordModal').classList.remove('active');
      
      alert('Savol muvaffaqiyatli joylandi!');
      render();
    });

    // Cancel password
    document.getElementById('cancelPasswordBtn').addEventListener('click', () => {
      document.getElementById('passwordInput').value = '';
      document.getElementById('passwordModal').classList.remove('active');
    });

    // Add answer
    document.getElementById('addAnswerBtn').addEventListener('click', () => {
      const answer = document.getElementById('answerInput').value.trim();
      if (!answer) {
        alert('Javobni yozing!');
        return;
      }

      const data = getData();
      if (!data.current || !data.current.question) {
        alert('Hozirda savol yo\'q!');
        return;
      }

      data.current.answers.unshift(answer);
      saveData(data.current, null);

      document.getElementById('answerInput').value = '';
      alert('Javob yuborildi!');
      render();
    });

    // Render main view
    function render() {
      const data = getData();
      
      // Render current question
      const questionDiv = document.getElementById('currentQuestion');
      if (data.current && data.current.question) {
        questionDiv.innerHTML = `<p class="question-display">${escapeHtml(data.current.question)}</p>`;
      } else {
        questionDiv.innerHTML = '<p class="empty-state">Hozirda savol yo\'q</p>';
      }

      // Render answers
      const answersDiv = document.getElementById('answersList');
      const answers = data.current ? data.current.answers || [] : [];
      
      document.getElementById('answerCount').textContent = `(${answers.length})`;

      if (answers.length === 0) {
        answersDiv.innerHTML = '<p class="empty-state">Hozircha javoblar yo\'q. Birinchi bo\'lib javob qoldiring!</p>';
      } else {
        answersDiv.innerHTML = answers.map(ans => 
          `<div class="answer">${escapeHtml(ans)}</div>`
        ).join('');
      }
    }

    // Render archive
    function renderArchive() {
      const data = getData();
      const archiveDiv = document.getElementById('archiveList');

      if (data.archive.length === 0) {
        archiveDiv.innerHTML = '<p class="empty-state">Arxivda hech narsa yo\'q</p>';
        return;
      }

      archiveDiv.innerHTML = data.archive.map(item => `
        <div class="archive-item">
          <div class="archive-header">
            <h3 class="archive-question">${escapeHtml(item.question)}</h3>
            <span class="archive-date">${item.date}</span>
          </div>
          <div class="archive-answers">
            <p class="archive-count">${item.answers.length} javob</p>
            ${item.answers.slice(0, 3).map(ans => 
              `<div class="archive-answer">${escapeHtml(ans)}</div>`
            ).join('')}
            ${item.answers.length > 3 ? 
              `<p class="archive-more">... va yana ${item.answers.length - 3} javob</p>` : 
              ''
            }
          </div>
        </div>
      `).join('');
    }

    // Enter key support for password
    document.getElementById('passwordInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        document.getElementById('confirmPasswordBtn').click();
      }
    });

    // Initial render
    render();
  </script>
</body>
</html>
